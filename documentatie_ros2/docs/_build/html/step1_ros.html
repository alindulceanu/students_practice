


<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN" "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">
<html xml:lang="" lang="" version="-//W3C//DTD XHTML 1.1//EN" xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

  
  <title>Basic talker tutorial &mdash; Documentatie ros2 1.0 documentation</title>
  

  

  

    <link href='https://fonts.googleapis.com/css?family=Lato:400,700,400italic,700italic|Roboto+Slab:400,700|Inconsolata:400,700' rel='stylesheet' type='text/css'/>
    <link rel="stylesheet" href="_static/css/pdj.css" type="text/css" />

  
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  
    <link rel="stylesheet" href="_static/css/pdj.css" type="text/css" />
  
    <link rel="stylesheet" href="_static/copybutton.css" type="text/css" />
  

  

  
        <link rel="index" title="Index"
              href="genindex.html"/>
        <link rel="search" title="Search" href="search.html"/>
    <link rel="top" title="Documentatie ros2 1.0 documentation" href="index.html"/>
        <link rel="next" title="Installing Docker Desktop" href="docker.html"/>
        <link rel="prev" title="Getting started" href="start.html"/>

    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <meta http-equiv="cache-control" content="public" />
    <meta name="robots" content="follow, all" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <!-- Add jQuery library -->
    <script type="text/javascript" src="http://code.jquery.com/jquery-latest.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/modernizr/2.6.2/modernizr.min.js"></script>

  </head>

  <body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-nav-search">
        <a href="index.html" class="fa fa-home"> Documentatie ros2 </a>
        <div role="search">
	  <form id ="rtd-search-form" class="wy-form"
		action="search.html" method="get">
	    <input type="text" name="q" placeholder="Search docs" />
	    <input type="hidden" name="check_keywords" value="yes" />
	    <input type="hidden" name="area" value="default" />
	  </form>
	</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
	
          
          
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="setup.html">Preparations</a><ul>
<li class="toctree-l2"><a class="reference internal" href="setup.html#ubuntu-debian-packages">Ubuntu (Debian packages)</a></li>
<li class="toctree-l2"><a class="reference internal" href="setup.html#resources">Resources</a></li>
<li class="toctree-l2"><a class="reference internal" href="setup.html#system-setup">System setup</a></li>
<li class="toctree-l2"><a class="reference internal" href="setup.html#install-ros-2">Install ROS 2</a></li>
<li class="toctree-l2"><a class="reference internal" href="setup.html#setup-environment">Setup environment</a></li>
<li class="toctree-l2"><a class="reference internal" href="setup.html#try-some-examples">Try some examples</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="start.html">Getting started</a><ul>
<li class="toctree-l2"><a class="reference internal" href="start.html#introduction">Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="start.html#creating-the-environment">Creating the environment</a></li>
</ul>
</li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Basic talker tutorial</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#creating-a-talker-using-python">Creating a talker using python</a></li>
<li class="toctree-l2"><a class="reference internal" href="#building-and-running-the-node">Building and running the node</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="docker.html">Installing Docker Desktop</a><ul>
<li class="toctree-l2"><a class="reference internal" href="docker.html#what-is-docker">What is Docker?</a></li>
<li class="toctree-l2"><a class="reference internal" href="docker.html#what-are-containers">What are containers?</a></li>
<li class="toctree-l2"><a class="reference internal" href="docker.html#why-use-containers">Why use containers?</a></li>
<li class="toctree-l2"><a class="reference internal" href="docker.html#setting-up-your-computer">Setting up your computer</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="docker.html#hello-world">HELLO WORLD</a><ul>
<li class="toctree-l2"><a class="reference internal" href="docker.html#playing-with-busybox">Playing with Busybox</a></li>
<li class="toctree-l2"><a class="reference internal" href="docker.html#docker-run">Docker Run</a></li>
<li class="toctree-l2"><a class="reference internal" href="docker.html#terminology">Terminology</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="docker.html#webapps-with-docker">WEBAPPS WITH DOCKER</a><ul>
<li class="toctree-l2"><a class="reference internal" href="docker.html#dockerfile">Dockerfile</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="docker.html#conclusion">CONCLUSION</a></li>
<li class="toctree-l1"><a class="reference internal" href="VMBox.html">VMBox</a><ul>
<li class="toctree-l2"><a class="reference internal" href="VMBox.html#welcome-to-oracle-vm-virtualbox">Welcome to Oracle VM VirtualBox.</a></li>
<li class="toctree-l2"><a class="reference internal" href="VMBox.html#why-is-virtualization-useful">Why is Virtualization Useful?</a></li>
<li class="toctree-l2"><a class="reference internal" href="VMBox.html#some-terminology">Some Terminology</a></li>
<li class="toctree-l2"><a class="reference internal" href="VMBox.html#features-overview">Features Overview</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="VMBox.html#supported-host-operating-systems">Supported Host Operating Systems</a><ul>
<li class="toctree-l2"><a class="reference internal" href="VMBox.html#host-cpu-requirements">Host CPU Requirements</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="VMBox.html#installing-oracle-vm-virtualbox-and-extension-packs">Installing Oracle VM VirtualBox and Extension Packs</a></li>
<li class="toctree-l1"><a class="reference internal" href="VMBox.html#starting-oracle-vm-virtualbox">Starting Oracle VM VirtualBox</a></li>
<li class="toctree-l1"><a class="reference internal" href="VMBox.html#virtualbox-manager">VirtualBox Manager</a></li>
<li class="toctree-l1"><a class="reference internal" href="VMBox.html#the-machine-list">The Machine List</a></li>
<li class="toctree-l1"><a class="reference internal" href="VMBox.html#the-details-pane">The Details Pane</a><ul>
<li class="toctree-l2"><a class="reference internal" href="VMBox.html#virtualbox-manager-toolbar">VirtualBox Manager Toolbar</a></li>
<li class="toctree-l2"><a class="reference internal" href="VMBox.html#settings">Settings</a></li>
<li class="toctree-l2"><a class="reference internal" href="VMBox.html#preview-window">Preview Window</a></li>
<li class="toctree-l2"><a class="reference internal" href="VMBox.html#notification-center">Notification Center</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="VMBox.html#virtualbox-manager-tools">VirtualBox Manager Tools</a><ul>
<li class="toctree-l2"><a class="reference internal" href="VMBox.html#global-tools">Global Tools</a></li>
<li class="toctree-l2"><a class="reference internal" href="VMBox.html#machine-tools">Machine Tools</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="VMBox.html#help-viewer">Help Viewer</a></li>
<li class="toctree-l1"><a class="reference internal" href="VMBox.html#about-virtualbox-manager-wizards">About VirtualBox Manager Wizards</a></li>
<li class="toctree-l1"><a class="reference internal" href="VMBox.html#creating-your-first-virtual-machine">Creating Your First Virtual Machine</a><ul>
<li class="toctree-l2"><a class="reference internal" href="VMBox.html#create-virtual-machine-wizard-name-and-operating-system">Create Virtual Machine Wizard: Name and Operating System</a></li>
<li class="toctree-l2"><a class="reference internal" href="VMBox.html#create-virtual-machine-wizard-hardware">Create Virtual Machine Wizard: Hardware</a></li>
<li class="toctree-l2"><a class="reference internal" href="VMBox.html#create-virtual-machine-wizard-virtual-hard-disk">Create Virtual Machine Wizard: Virtual Hard Disk</a></li>
<li class="toctree-l2"><a class="reference internal" href="VMBox.html#create-virtual-machine-wizard-summary">Create Virtual Machine Wizard: Summary</a></li>
<li class="toctree-l2"><a class="reference internal" href="VMBox.html#some-examples-of-unattended-installation">Some Examples of Unattended Installation</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="VMBox.html#running-your-virtual-machine">Running Your Virtual Machine</a><ul>
<li class="toctree-l2"><a class="reference internal" href="VMBox.html#starting-a-new-vm-for-the-first-time">Starting a New VM for the First Time</a></li>
<li class="toctree-l2"><a class="reference internal" href="VMBox.html#capturing-and-releasing-keyboard-and-mouse">Capturing and Releasing Keyboard and Mouse</a></li>
<li class="toctree-l2"><a class="reference internal" href="VMBox.html#typing-special-characters">Typing Special Characters</a></li>
<li class="toctree-l2"><a class="reference internal" href="VMBox.html#changing-removable-media">Changing Removable Media</a></li>
<li class="toctree-l2"><a class="reference internal" href="VMBox.html#resizing-the-machine-s-window">Resizing the Machine’s Window</a></li>
<li class="toctree-l2"><a class="reference internal" href="VMBox.html#saving-the-state-of-the-machine">Saving the State of the Machine</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="framefinder.html">Making a rosbag frame, topic and value reader</a></li>
<li class="toctree-l1"><a class="reference internal" href="wsl2.html">WSL2</a><ul>
<li class="toctree-l2"><a class="reference internal" href="wsl2.html#installation">Installation</a></li>
<li class="toctree-l2"><a class="reference internal" href="wsl2.html#setting-up-the-linux-user">Setting up the linux user</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="talker.html">Making a ros2 talker</a></li>
<li class="toctree-l1"><a class="reference internal" href="subscriber.html">Making a ros2 subscriber</a><ul>
<li class="toctree-l2"><a class="reference internal" href="subscriber.html#initialization-method">Initialization Method</a></li>
<li class="toctree-l2"><a class="reference internal" href="subscriber.html#callback-function">Callback Function</a></li>
<li class="toctree-l2"><a class="reference internal" href="subscriber.html#main-function">Main Function</a></li>
<li class="toctree-l2"><a class="reference internal" href="subscriber.html#final-result">Final result</a></li>
<li class="toctree-l2"><a class="reference internal" href="subscriber.html#add-an-entry-point">Add an entry point</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="ScriptDock.html">Making a script to directly open the virtual image with docker and mount itself in vs code</a></li>
<li class="toctree-l1"><a class="reference internal" href="MobaX.html">Installing MobaXTerm</a><ul>
<li class="toctree-l2"><a class="reference internal" href="MobaX.html#mobaxterm-x-server-and-ssh-client">MobaXterm X server and SSH client</a></li>
<li class="toctree-l2"><a class="reference internal" href="MobaX.html#key-features">Key features</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="DockerVS.html">Docker container in VSCode</a></li>
<li class="toctree-l1"><a class="reference internal" href="DockerVS.html#installing-docker-on-ubuntu">Installing Docker on Ubuntu</a><ul>
<li class="toctree-l2"><a class="reference internal" href="DockerVS.html#prerequisites">Prerequisites</a></li>
<li class="toctree-l2"><a class="reference internal" href="DockerVS.html#os-requirements">OS requirements:</a></li>
<li class="toctree-l2"><a class="reference internal" href="DockerVS.html#uninstall-old-versions">Uninstall old versions</a></li>
<li class="toctree-l2"><a class="reference internal" href="DockerVS.html#installation-methods">Installation methods</a></li>
<li class="toctree-l2"><a class="reference internal" href="DockerVS.html#install-using-the-apt-repository">Install using the apt repository</a></li>
<li class="toctree-l2"><a class="reference internal" href="DockerVS.html#set-up-the-repository">Set up the repository</a></li>
<li class="toctree-l2"><a class="reference internal" href="DockerVS.html#install-docker-engine">Install Docker Engine</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="DockerVS.html#uninstall-docker-engine">Uninstall Docker Engine</a></li>
<li class="toctree-l1"><a class="reference internal" href="DockerVS.html#linux-post-installation-steps-for-docker-engine">Linux post-installation steps for Docker Engine</a><ul>
<li class="toctree-l2"><a class="reference internal" href="DockerVS.html#manage-docker-as-a-non-root-user">Manage Docker as a non-root user</a></li>
<li class="toctree-l2"><a class="reference internal" href="DockerVS.html#configure-docker-to-start-on-boot-with-systemd">Configure Docker to start on boot with systemd</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="rosbag_reader.html">Making a rosbag reader</a><ul>
<li class="toctree-l2"><a class="reference internal" href="rosbag_reader.html#what-is-pandas">What is pandas?</a></li>
<li class="toctree-l2"><a class="reference internal" href="rosbag_reader.html#making-the-script">Making the script</a></li>
<li class="toctree-l2"><a class="reference internal" href="rosbag_reader.html#executing-the-code">Executing the code</a></li>
</ul>
</li>
</ul>

          
        

      </div>
      &nbsp;
    </nav>
    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      <nav class="wy-nav-top" id="barra-mobile" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="#">Porão do Juca</a>
      </nav>

      <div class="wy-nav-content">
	<div class="fundo-claro">
	</div>
	<div class="fundo-escuro">
	</div>

        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
	    
	    <!-- <ul class="wy-breadcrumbs"> -->
	    <!--   <li><a href="#">Docs</a> &raquo;</li> -->

	    <!--   <li>Features</li> -->
	    <!--   <li class="wy-breadcrumbs-aside"> -->

	    <!-- 	<a href="_sources/index.txt" rel="nofollow"> View page source</a> -->

	    <!--   </li> -->
	    <!-- </ul> -->
	    <!-- <hr/> -->
	  </div>

          <div role="main" class="">

	    <div id="content" class="hfeed entry-container hentry">
  <section id="basic-talker-tutorial">
<h1>Basic talker tutorial<a class="headerlink" href="#basic-talker-tutorial" title="Permalink to this heading">¶</a></h1>
<p>Now that we have our setup complete, we can start experimenting with the tools <code class="docutils literal notranslate"><span class="pre">ROS2</span></code> has to offer.</p>
<nav class="contents local" id="table-of-contents">
<p class="topic-title">Table of Contents</p>
<ul class="simple">
<li><p><a class="reference internal" href="#creating-a-talker-using-python" id="id1">Creating a talker using python</a></p>
<ul>
<li><p><a class="reference internal" href="#what-is-a-talker" id="id2">What is a talker?</a></p></li>
<li><p><a class="reference internal" href="#full-code" id="id3">Full code</a></p></li>
<li><p><a class="reference internal" href="#explaining-the-code" id="id4">Explaining the code</a></p></li>
<li><p><a class="reference internal" href="#adding-dependencies-to-the-ros-package" id="id5">Adding dependencies to the ROS package</a></p></li>
<li><p><a class="reference internal" href="#editing-the-entry-points-in-setup-py" id="id6">Editing the entry points in setup.py</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#building-and-running-the-node" id="id7">Building and running the node</a></p></li>
</ul>
</nav>
<section id="creating-a-talker-using-python">
<h2><a class="toc-backref" href="#id1" role="doc-backlink">Creating a talker using python</a><a class="headerlink" href="#creating-a-talker-using-python" title="Permalink to this heading">¶</a></h2>
<section id="what-is-a-talker">
<h3><a class="toc-backref" href="#id2" role="doc-backlink">What is a talker?</a><a class="headerlink" href="#what-is-a-talker" title="Permalink to this heading">¶</a></h3>
<p>A talker node is used to send data to a <code class="docutils literal notranslate"><span class="pre">topic</span></code>. This data can be sensor values, commands, camera frames, etc..</p>
<p>In order to create one we need to go inside our project directory that we’ve built in the previous chapter.</p>
<p>Inside that directory we’ll find some configuration files that we will discuss later in this tutorial and another directory named exactly like the package name.</p>
<p>Inside that directory we want to create our python script:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">touch</span> <span class="n">talker</span><span class="o">.</span><span class="n">py</span> <span class="o">&amp;&amp;</span> <span class="n">chmod</span> <span class="mi">700</span> <span class="n">talker</span><span class="o">.</span><span class="n">py</span>
</pre></div>
</div>
<p>Now you can use any code editor you preffer. I recommend <code class="docutils literal notranslate"><span class="pre">VSCode</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">code</span> <span class="n">talker</span><span class="o">.</span><span class="n">py</span>
</pre></div>
</div>
</section>
<section id="full-code">
<h3><a class="toc-backref" href="#id3" role="doc-backlink">Full code</a><a class="headerlink" href="#full-code" title="Permalink to this heading">¶</a></h3>
<p>Inside it place this code:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="ch">#!/usr/bin/env python3</span>

<span class="kn">import</span> <span class="nn">argparse</span>
<span class="kn">import</span> <span class="nn">rclpy</span>
<span class="kn">from</span> <span class="nn">rclpy.node</span> <span class="kn">import</span> <span class="n">Node</span>
<span class="kn">from</span> <span class="nn">geometry_msgs.msg</span> <span class="kn">import</span> <span class="n">Twist</span>
<span class="kn">import</span> <span class="nn">random</span>

<span class="k">class</span> <span class="nc">publisherNode</span><span class="p">(</span><span class="n">Node</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">topic</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="s2">&quot;My_Publisher_NODE&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">get_logger</span><span class="p">()</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Publisher has been started!&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">topic</span> <span class="o">=</span> <span class="n">topic</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">publisher_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_publisher</span><span class="p">(</span><span class="n">Twist</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">topic</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">timer_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_timer</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">publishMessage</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">publishMessage</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">msg</span> <span class="o">=</span> <span class="n">Twist</span><span class="p">()</span>

        <span class="n">msg</span><span class="o">.</span><span class="n">linear</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">()</span> <span class="o">+</span> <span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">99</span><span class="p">)</span>
        <span class="n">msg</span><span class="o">.</span><span class="n">linear</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">()</span> <span class="o">+</span> <span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">99</span><span class="p">)</span>
        <span class="n">msg</span><span class="o">.</span><span class="n">linear</span><span class="o">.</span><span class="n">z</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">()</span> <span class="o">+</span> <span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">99</span><span class="p">)</span>

        <span class="n">msg</span><span class="o">.</span><span class="n">angular</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">()</span> <span class="o">+</span> <span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">99</span><span class="p">)</span>
        <span class="n">msg</span><span class="o">.</span><span class="n">angular</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">()</span> <span class="o">+</span> <span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">99</span><span class="p">)</span>
        <span class="n">msg</span><span class="o">.</span><span class="n">angular</span><span class="o">.</span><span class="n">z</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">()</span> <span class="o">+</span> <span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">99</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">publisher_</span><span class="o">.</span><span class="n">publish</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">main</span><span class="p">(</span><span class="n">args</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
    <span class="n">rclpy</span><span class="o">.</span><span class="n">init</span><span class="p">(</span><span class="n">args</span> <span class="o">=</span> <span class="n">args</span><span class="p">)</span>

    <span class="n">parser</span> <span class="o">=</span> <span class="n">argparse</span><span class="o">.</span><span class="n">ArgumentParser</span><span class="p">(</span><span class="n">description</span><span class="o">=</span><span class="vm">__doc__</span><span class="p">)</span>
    <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s2">&quot;input&quot;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s2">&quot;topic name&quot;</span><span class="p">)</span>
    <span class="n">args</span> <span class="o">=</span> <span class="n">parser</span><span class="o">.</span><span class="n">parse_args</span><span class="p">()</span>

    <span class="n">node</span> <span class="o">=</span> <span class="n">publisherNode</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">args</span><span class="o">.</span><span class="n">input</span><span class="p">))</span>
    <span class="n">rclpy</span><span class="o">.</span><span class="n">spin</span><span class="p">(</span><span class="n">node</span><span class="p">)</span>

    <span class="n">rclpy</span><span class="o">.</span><span class="n">shutdown</span><span class="p">()</span>
</pre></div>
</div>
</section>
<section id="explaining-the-code">
<h3><a class="toc-backref" href="#id4" role="doc-backlink">Explaining the code</a><a class="headerlink" href="#explaining-the-code" title="Permalink to this heading">¶</a></h3>
<p>Now let’s make a quick walktrough:</p>
<p>For every <code class="docutils literal notranslate"><span class="pre">node</span></code> in ROS2 you need to specify the path of the interpretter.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="ch">#!/usr/bin/env python3</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">Argparse</span></code> is a built-in python library that enables a script to receive arguments directly from a console.</p>
<p><code class="docutils literal notranslate"><span class="pre">rclpy</span></code> is the main library that we’ll use for ROS.</p>
<p><code class="docutils literal notranslate"><span class="pre">rclpy.node.Node</span></code> is a class from rclpy that we will inherit every time we want to build a node, this will give us tons of tools that can be easily implemented in out code.</p>
<p><code class="docutils literal notranslate"><span class="pre">geometry_msgs</span></code> is a library from ROS that contains many classes with the purpose of storing a specific message.</p>
<p><code class="docutils literal notranslate"><span class="pre">Twist</span></code> is a message type that we we’ll send over to a topic below.</p>
<p><code class="docutils literal notranslate"><span class="pre">random</span></code> is another python built-in module that helps us generate random numbers, we’ll use it to create unique messages to send</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">argparse</span>
<span class="kn">import</span> <span class="nn">rclpy</span>
<span class="kn">from</span> <span class="nn">rclpy.node</span> <span class="kn">import</span> <span class="n">Node</span>
<span class="kn">from</span> <span class="nn">geometry_msgs.msg</span> <span class="kn">import</span> <span class="n">Twist</span>
<span class="kn">import</span> <span class="nn">random</span>
</pre></div>
</div>
<p>The first step in creating a node is inheriting the Node class mentioned above and using the <code class="docutils literal notranslate"><span class="pre">super()</span></code> method.</p>
<p>The text inside the super() method is what will the node be seen as inside rqt_graph</p>
<p>Line 4 is the message the node will return on the terminal if it has started succesfully.</p>
<p>When runnning the node, we will use the topic name we want to assign as an argument that we’ll use below.</p>
<p><code class="docutils literal notranslate"><span class="pre">self.publisher_</span></code> is an object that we’ll use to send Twist type messages in the <code class="docutils literal notranslate"><span class="pre">self.topic</span></code>
topic while “10” is the queue size for the output buffer, “10” is the most commonly used value.</p>
<p><code class="docutils literal notranslate"><span class="pre">self.timer_</span></code> is an object that will call a chosen function every “1” second.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">publisherNode</span><span class="p">(</span><span class="n">Node</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">topic</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="s2">&quot;My_Publisher_NODE&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">get_logger</span><span class="p">()</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Publisher has been started!&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">topic</span> <span class="o">=</span> <span class="n">topic</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">publisher_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_publisher</span><span class="p">(</span><span class="n">Twist</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">topic</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">timer_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_timer</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">publishMessage</span><span class="p">)</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">msg</span></code> will be the message that we want to send, we declare it as an object of the Twist() class</p>
<p><code class="docutils literal notranslate"><span class="pre">Twist()</span></code> has 6 internal variables that we can use as messages: linear and angualar velocities for every axis</p>
<p>We edit those using the <code class="docutils literal notranslate"><span class="pre">random</span></code> module to generate unique numbers</p>
<p>After that, we use the .publish method of our <code class="docutils literal notranslate"><span class="pre">self.publisher_</span></code> object we created earlier to send the message in the topic</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>    <span class="k">def</span> <span class="nf">publishMessage</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">msg</span> <span class="o">=</span> <span class="n">Twist</span><span class="p">()</span>

        <span class="n">msg</span><span class="o">.</span><span class="n">linear</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">()</span> <span class="o">+</span> <span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">99</span><span class="p">)</span>
        <span class="n">msg</span><span class="o">.</span><span class="n">linear</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">()</span> <span class="o">+</span> <span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">99</span><span class="p">)</span>
        <span class="n">msg</span><span class="o">.</span><span class="n">linear</span><span class="o">.</span><span class="n">z</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">()</span> <span class="o">+</span> <span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">99</span><span class="p">)</span>

        <span class="n">msg</span><span class="o">.</span><span class="n">angular</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">()</span> <span class="o">+</span> <span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">99</span><span class="p">)</span>
        <span class="n">msg</span><span class="o">.</span><span class="n">angular</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">()</span> <span class="o">+</span> <span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">99</span><span class="p">)</span>
        <span class="n">msg</span><span class="o">.</span><span class="n">angular</span><span class="o">.</span><span class="n">z</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">()</span> <span class="o">+</span> <span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">99</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">publisher_</span><span class="o">.</span><span class="n">publish</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
</pre></div>
</div>
<p>This is the main function. This is the function that ROS will call in order to activate the node.</p>
<p><code class="docutils literal notranslate"><span class="pre">rclpy.init()</span></code> and <code class="docutils literal notranslate"><span class="pre">rclpy.shutdown()</span></code> are 2 functions that need to be called every single time you want to start a node of any kind in ROS and
and they must be placed at the beginning and at the end of the main function.</p>
<p>Next, we’ll use argparse to create a parser for the input, which will be the name of the target topic in our case.</p>
<p>We initialize an object of our class we’ve just created and send the topic name as an argument for it.</p>
<p><code class="docutils literal notranslate"><span class="pre">rclpy.spin()</span></code> is a function that makes the node keep working after the first iteration until we manually close it.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">main</span><span class="p">(</span><span class="n">args</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
    <span class="n">rclpy</span><span class="o">.</span><span class="n">init</span><span class="p">(</span><span class="n">args</span> <span class="o">=</span> <span class="n">args</span><span class="p">)</span>

    <span class="n">parser</span> <span class="o">=</span> <span class="n">argparse</span><span class="o">.</span><span class="n">ArgumentParser</span><span class="p">(</span><span class="n">description</span><span class="o">=</span><span class="vm">__doc__</span><span class="p">)</span>
    <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s2">&quot;input&quot;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s2">&quot;topic name&quot;</span><span class="p">)</span>
    <span class="n">args</span> <span class="o">=</span> <span class="n">parser</span><span class="o">.</span><span class="n">parse_args</span><span class="p">()</span>

    <span class="n">node</span> <span class="o">=</span> <span class="n">publisherNode</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">args</span><span class="o">.</span><span class="n">input</span><span class="p">))</span>
    <span class="n">rclpy</span><span class="o">.</span><span class="n">spin</span><span class="p">(</span><span class="n">node</span><span class="p">)</span>

    <span class="n">rclpy</span><span class="o">.</span><span class="n">shutdown</span><span class="p">()</span>
</pre></div>
</div>
</section>
<section id="adding-dependencies-to-the-ros-package">
<h3><a class="toc-backref" href="#id5" role="doc-backlink">Adding dependencies to the ROS package</a><a class="headerlink" href="#adding-dependencies-to-the-ros-package" title="Permalink to this heading">¶</a></h3>
<p>In the <code class="docutils literal notranslate"><span class="pre">src/&quot;your_package_name&quot;</span></code> you will find a file named <code class="docutils literal notranslate"><span class="pre">package.xml</span></code>, open it:</p>
<p>Inside the file there is a section that has <code class="docutils literal notranslate"><span class="pre">&lt;depend&gt;&lt;/depend&gt;</span></code> tags.</p>
<p>You want to add the following dependencies:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;</span><span class="n">depend</span><span class="o">&gt;</span><span class="n">random</span><span class="o">&lt;/</span><span class="n">depend</span><span class="o">&gt;</span>
<span class="o">&lt;</span><span class="n">depend</span><span class="o">&gt;</span><span class="n">rclpy</span><span class="o">&lt;/</span><span class="n">depend</span><span class="o">&gt;</span>
<span class="o">&lt;</span><span class="n">depend</span><span class="o">&gt;</span><span class="n">geometry_msgs</span><span class="o">&lt;/</span><span class="n">depend</span><span class="o">&gt;</span>
<span class="o">&lt;</span><span class="n">depend</span><span class="o">&gt;</span><span class="n">argparse</span><span class="o">&lt;/</span><span class="n">depend</span><span class="o">&gt;</span>
</pre></div>
</div>
<p>Now save and close the file.</p>
</section>
<section id="editing-the-entry-points-in-setup-py">
<h3><a class="toc-backref" href="#id6" role="doc-backlink">Editing the entry points in setup.py</a><a class="headerlink" href="#editing-the-entry-points-in-setup-py" title="Permalink to this heading">¶</a></h3>
<p>In the same directory you will find a file named setup.py, open it.</p>
<p>At the bottom of the code you should have the <code class="docutils literal notranslate"><span class="pre">entry_points</span></code>.</p>
<p>In <code class="docutils literal notranslate"><span class="pre">console_scripts</span> <span class="pre">add</span> <span class="pre">the</span> <span class="pre">following</span> <span class="pre">line</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="s2">&quot;publisher = my_package_name.my_publisher_file_name:main&quot;</span>
</pre></div>
</div>
<p>Replace <code class="docutils literal notranslate"><span class="pre">my_package_name</span></code> with the name you have chosen for your ROS project name
and <code class="docutils literal notranslate"><span class="pre">my_publisher_file_name</span></code> with the name of the file your publisher code is.</p>
<p>It should look like this:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">entry_points</span><span class="o">=</span><span class="p">{</span>
    <span class="s1">&#39;console_scripts&#39;</span><span class="p">:[</span>
        <span class="s2">&quot;publisher = my_package.publisher:main&quot;</span>
    <span class="p">],</span>
<span class="p">},</span>
</pre></div>
</div>
<p>Keep in mind that “publisher” is the name of the executable we will use to call this node.</p>
</section>
</section>
<section id="building-and-running-the-node">
<h2><a class="toc-backref" href="#id7" role="doc-backlink">Building and running the node</a><a class="headerlink" href="#building-and-running-the-node" title="Permalink to this heading">¶</a></h2>
<p>Now that everything has been coded, all we have to do is to go back into our <code class="docutils literal notranslate"><span class="pre">src</span></code> directory
and execute this command:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">colcon</span> <span class="n">build</span> <span class="o">--</span><span class="n">symlink</span><span class="o">-</span><span class="n">install</span>
</pre></div>
</div>
<p>Using <code class="docutils literal notranslate"><span class="pre">--symlink-install</span></code> is not mandatory, but if you use it, you won’t have to build the project everytime you modify the code of this node.
(you still have to rebuild it if you add another node)</p>
<p>Now in order to run it you need to use this command:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ros2</span> <span class="n">run</span> <span class="o">&lt;</span><span class="n">my_package_name</span><span class="o">&gt;</span> <span class="o">&lt;</span><span class="n">executable_name</span><span class="o">&gt;</span> <span class="o">&lt;</span><span class="n">topic_name</span><span class="o">&gt;</span>
</pre></div>
</div>
<p>In order to see the messages that are being sent, use the following command inside another terminal:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ros2</span> <span class="n">topic</span> <span class="n">echo</span> <span class="o">&lt;</span><span class="n">topic_name</span><span class="o">&gt;</span>
</pre></div>
</div>
<p>You can also visualize the node and the topic using:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">rqt_graph</span>
</pre></div>
</div>
<p>And:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ros2</span> <span class="n">topic</span> <span class="nb">list</span>
</pre></div>
</div>
</section>
</section>


	    </div>
            <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="docker.html" class="btn btn-neutral float-right" title="Installing Docker Desktop">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="start.html" class="btn btn-neutral" title="Getting started"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2023, Alin Dulceanu, Eduard Cimpean.
    </p>
  </div>

  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/jucacrispim/sphinx_pdj_theme">theme</a> provided by <a href="http://poraodojuca.net">Porão do Juca</a>.

</footer>
	</div>
	</div>
	  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'1.0',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
    <script type="text/javascript" src="_static/documentation_options.js">

    </script>
    <script type="text/javascript" src="_static/doctools.js">

    </script>
    <script type="text/javascript" src="_static/sphinx_highlight.js">

    </script>
    <script type="text/javascript" src="_static/clipboard.min.js">

    </script>
    <script type="text/javascript" src="_static/copybutton.js">

    </script>

  

   <script type="text/javascript"
           src="_static/js/theme.js"></script>

   <script type="text/javascript"
           src="_static/js/pdj.js"></script>

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

  </body>
</html>